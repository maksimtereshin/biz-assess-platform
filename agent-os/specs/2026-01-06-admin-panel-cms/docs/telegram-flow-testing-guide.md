# Telegram Flow Testing Guide
## Task 6.5: –ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –≤ Telegram –±–æ—Ç–∞

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è**: 2026-01-09
**–í–µ—Ä—Å–∏—è**: 1.0

---

## –¶–µ–ª—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª–Ω—ã–π flow –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —Å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å—é —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞:
1. –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è JWT —Ç–æ–∫–µ–Ω–æ–≤
3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—Ö–æ–¥ –≤ AdminJS —á–µ—Ä–µ–∑ WebApp
4. –°–∫—Ä—ã—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ –¥–ª—è –Ω–µ–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

---

## –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 1. Backend –∑–∞–ø—É—â–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω
```bash
docker ps | grep bizass-backend-dev
# –î–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å: Up X hours (healthy)
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –≤ –ë–î
```bash
./dev.sh db
# –í psql:
SELECT id, telegram_username, created_at FROM admins ORDER BY created_at;
```

**–û–∂–∏–¥–∞–µ–º—ã–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã:**
- `maksim_tereshin` (–ø–µ—Ä–≤—ã–π admin, created_by = NULL)
- `bogdanov_admin` (–≤—Ç–æ—Ä–æ–π admin, created_by = maksim_tereshin)

### 3. Telegram –±–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω
- –ë–æ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ username (–∏–∑ `.env`)
- Webhook –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ backend URL

---

## Test Case 1: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –≤–∏–¥–∏—Ç –∫–Ω–æ–ø–∫—É –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

**–ü—Ä–µ–¥—É—Å–ª–æ–≤–∏—è:**
- Telegram username –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ = `maksim_tereshin` (–∏–ª–∏ –¥—Ä—É–≥–æ–π –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `admins`)

**–®–∞–≥–∏:**
1. –û—Ç–∫—Ä—ã—Ç—å Telegram –±–æ—Ç
2. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—É `/start`
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é (inline keyboard)

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–Ω–æ–ø–∫—É "üîß –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å"
‚úÖ –ö–Ω–æ–ø–∫–∞ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∞ –≤ –Ω–∏–∂–Ω–µ–π —á–∞—Å—Ç–∏ inline keyboard
‚úÖ callback_data –∫–Ω–æ–ø–∫–∏ = "admin_panel"
```

**–°–∫—Ä–∏–Ω—à–æ—Ç:**
![Admin Panel Button](../verification/screenshots/telegram-admin-button.png)

---

## Test Case 2: –ù–∞–∂–∞—Ç–∏–µ –Ω–∞ –∫–Ω–æ–ø–∫—É –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

**–ü—Ä–µ–¥—É—Å–ª–æ–≤–∏—è:**
- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –≤–∏–¥–∏—Ç –∫–Ω–æ–ø–∫—É "üîß –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å"

**–®–∞–≥–∏:**
1. –ù–∞–∂–∞—Ç—å –Ω–∞ –∫–Ω–æ–ø–∫—É "üîß –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å"
2. –î–æ–∂–¥–∞—Ç—å—Å—è –æ—Ç–≤–µ—Ç–∞ –±–æ—Ç–∞

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ –ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Ç–µ–∫—Å—Ç–æ–º "üîß –û—Ç–∫—Ä—ã—Ç—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å"
‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç WebApp –∫–Ω–æ–ø–∫—É —Å —Ç–µ–∫—Å—Ç–æ–º "–û—Ç–∫—Ä—ã—Ç—å"
‚úÖ URL WebApp –∫–Ω–æ–ø–∫–∏ = ${BACKEND_URL}/admin?token=${JWT_TOKEN}
‚úÖ –¢–æ–∫–µ–Ω –∏–º–µ–µ—Ç —Ñ–æ—Ä–º–∞—Ç JWT (3 —á–∞—Å—Ç–∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—ã–µ —Ç–æ—á–∫–∞–º–∏)
```

**–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–∫–µ–Ω:**
- –î–ª–∏–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ (~200+ —Å–∏–º–≤–æ–ª–æ–≤)
- –§–æ—Ä–º–∞—Ç: `xxxxxx.xxxxxx.xxxxxx` (header.payload.signature)

**–°–∫—Ä–∏–Ω—à–æ—Ç:**
![WebApp Button Message](../verification/screenshots/telegram-webapp-button.png)

---

## Test Case 3: –û—Ç–∫—Ä—ã—Ç–∏–µ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ —á–µ—Ä–µ–∑ WebApp

**–ü—Ä–µ–¥—É—Å–ª–æ–≤–∏—è:**
- –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å WebApp –∫–Ω–æ–ø–∫–æ–π

**–®–∞–≥–∏:**
1. –ù–∞–∂–∞—Ç—å –Ω–∞ –∫–Ω–æ–ø–∫—É "–û—Ç–∫—Ä—ã—Ç—å"
2. –î–æ–∂–¥–∞—Ç—å—Å—è –∑–∞–≥—Ä—É–∑–∫–∏ WebApp
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å URL –∏ UI

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ WebApp –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ Telegram
‚úÖ –ü—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–¥–∏—Ä–µ–∫—Ç —Å /admin?token=xxx –Ω–∞ /admin
‚úÖ –¢–æ–∫–µ–Ω –∏—Å—á–µ–∑–∞–µ—Ç –∏–∑ URL –ø–æ—Å–ª–µ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞
‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è AdminJS UI
‚úÖ –í –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É –≤–∏–¥–Ω–æ: maksim_tereshin@telegram.user
‚úÖ Sidebar —Å–æ–¥–µ—Ä–∂–∏—Ç –≥—Ä—É–ø–ø—ã: "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ", "–û–ø—Ä–æ—Å—ã"
‚úÖ –†–µ—Å—É—Ä—Å—ã –¥–æ—Å—Ç—É–ø–Ω—ã: Admin, Survey, SurveyVersion, SurveySession
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ session:**
- –ó–∞–∫—Ä—ã—Ç—å WebApp
- –°–Ω–æ–≤–∞ –Ω–∞–∂–∞—Ç—å "–û—Ç–∫—Ä—ã—Ç—å" —á–µ—Ä–µ–∑ —Å—Ç–∞—Ä–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- ‚úÖ –í—Ö–æ–¥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º (session —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞)

**–°–∫—Ä–∏–Ω—à–æ—Ç—ã:**
![AdminJS Dashboard](../verification/screenshots/adminjs-dashboard.png)
![AdminJS Sidebar](../verification/screenshots/adminjs-sidebar.png)

---

## Test Case 4: –î–æ—Å—Ç—É–ø –∫ —Ä–µ—Å—É—Ä—Å–∞–º –≤ AdminJS

**–ü—Ä–µ–¥—É—Å–ª–æ–≤–∏—è:**
- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –≤–æ—à–µ–ª –≤ AdminJS

**–®–∞–≥–∏:**
1. –ù–∞–∂–∞—Ç—å –Ω–∞ "Survey Versions" –≤ sidebar
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å list view
3. –ù–∞–∂–∞—Ç—å –Ω–∞ –ª—é–±—É—é –≤–µ—Ä—Å–∏—é
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å show view

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ List view –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤—Å–µ –≤–µ—Ä—Å–∏–∏ –æ–ø—Ä–æ—Å–æ–≤
‚úÖ –í–∏–¥–Ω—ã –∫–æ–ª–æ–Ω–∫–∏: survey_id, version, name, type, status, published_at
‚úÖ Show view –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –¥–µ—Ç–∞–ª–∏ –≤–µ—Ä—Å–∏–∏
‚úÖ Custom actions –≤–∏–¥–Ω—ã: "–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é", "–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –≤–µ—Ä—Å–∏—é", "–°–Ω—è—Ç—å —Å –ø—É–±–ª–∏–∫–∞—Ü–∏–∏"
```

**–°–∫—Ä–∏–Ω—à–æ—Ç:**
![SurveyVersion List](../verification/screenshots/adminjs-survey-version-list.png)

---

## Test Case 5: –ù–µ–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –ù–ï –≤–∏–¥–∏—Ç –∫–Ω–æ–ø–∫—É

**–ü—Ä–µ–¥—É—Å–ª–æ–≤–∏—è:**
- Telegram username –ù–ï –≤ —Ç–∞–±–ª–∏—Ü–µ `admins`
- –ù–∞–ø—Ä–∏–º–µ—Ä: `test_user_123`

**–®–∞–≥–∏:**
1. –í–æ–π—Ç–∏ –≤ –±–æ—Ç–∞ —Å username = `test_user_123`
2. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—É `/start`
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –ù–ï —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–Ω–æ–ø–∫—É "üîß –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å"
‚úÖ –í–∏–¥–Ω—ã —Ç–æ–ª—å–∫–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∫–Ω–æ–ø–∫–∏: "–ü—Ä–æ–π—Ç–∏ —ç–∫—Å–ø—Ä–µ—Å—Å-–æ–ø—Ä–æ—Å", "–ü–æ–ª–Ω—ã–π –æ–ø—Ä–æ—Å", etc.
```

**–°–∫—Ä–∏–Ω—à–æ—Ç:**
![Non-Admin Menu](../verification/screenshots/telegram-non-admin-menu.png)

---

## Test Case 6: –ù–µ–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –ø–æ–ª—É—á–∞–µ—Ç 403 –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –¥–æ—Å—Ç—É–ø–∞

**–ü—Ä–µ–¥—É—Å–ª–æ–≤–∏—è:**
- –ù–µ–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –ø–æ–ª—É—á–∏–ª —Ç–æ–∫–µ–Ω –∫–∞–∫–∏–º-—Ç–æ –æ–±—Ä–∞–∑–æ–º (—Ä—É—á–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ)

**–®–∞–≥–∏:**
1. –°–æ–∑–¥–∞—Ç—å —Ç–æ–∫–µ–Ω –¥–ª—è –Ω–µ–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –≤—Ä—É—á–Ω—É—é:
   ```bash
   # –í backend/scripts/generate-admin-token.ts
   npm run generate-admin-token -- test_user_123
   ```
2. –û—Ç–∫—Ä—ã—Ç—å URL: `${BACKEND_URL}/admin?token=${TOKEN}`

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ 403 Forbidden
‚úÖ –¢–µ–∫—Å—Ç: "–í–∞—à Telegram username –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ —Å–ø–∏—Å–∫–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤"
‚úÖ –í—Ö–æ–¥ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω
```

**–°–∫—Ä–∏–Ω—à–æ—Ç:**
![403 Forbidden](../verification/screenshots/adminjs-403-forbidden.png)

---

## Test Case 7: –ò—Å—Ç–µ–∫—à–∏–π —Ç–æ–∫–µ–Ω

**–ü—Ä–µ–¥—É—Å–ª–æ–≤–∏—è:**
- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –ø–æ–ª—É—á–∏–ª —Ç–æ–∫–µ–Ω 16+ –º–∏–Ω—É—Ç –Ω–∞–∑–∞–¥

**–®–∞–≥–∏:**
1. –ü–æ–¥–æ–∂–¥–∞—Ç—å 16 –º–∏–Ω—É—Ç –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞
2. –ù–∞–∂–∞—Ç—å "–û—Ç–∫—Ä—ã—Ç—å" –≤ —Å—Ç–∞—Ä–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ "–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏"
‚úÖ –¢–µ–∫—Å—Ç: "–¢–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–∞ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∏–ª–∏ –∏—Å—Ç–µ–∫"
‚úÖ –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ: "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ —á–µ—Ä–µ–∑ Telegram –±–æ—Ç –∑–∞–Ω–æ–≤–æ"
```

**–†–µ—à–µ–Ω–∏–µ:**
- –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –±–æ—Ç–∞
- –°–Ω–æ–≤–∞ –Ω–∞–∂–∞—Ç—å "üîß –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å"
- –ü–æ–ª—É—á–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω

---

## –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Telegram MCP (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: Telegram MCP –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∫–∞–∫ Tier 3 (Optional) –≤ agent-os/config.yml.

```typescript
// Example: Using Telegram MCP for automated testing
import { mcp__telegram__send_message, mcp__telegram__get_updates } from './mcp-tools';

test('Admin sees admin panel button', async () => {
  // Send /start command as admin
  await mcp__telegram__send_message({
    chat_id: ADMIN_CHAT_ID,
    text: '/start'
  });

  // Get updates and check for admin panel button
  const updates = await mcp__telegram__get_updates();
  const lastMessage = updates[updates.length - 1];

  expect(lastMessage.reply_markup.inline_keyboard).toContainEqual(
    expect.arrayContaining([
      expect.objectContaining({
        text: 'üîß –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å',
        callback_data: 'admin_panel'
      })
    ])
  );
});
```

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è Telegram MCP:**
- –ù–µ –º–æ–∂–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å WebApp context (—Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–µ–∞–ª—å–Ω—ã–π Telegram –∫–ª–∏–µ–Ω—Ç)
- –ù–µ –º–æ–∂–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å payment flows
- –ü–æ–¥—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è –±–∞–∑–æ–≤–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ inline keyboards

---

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –ß–µ–∫–ª–∏—Å—Ç –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

- [ ] Test Case 1: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –≤–∏–¥–∏—Ç –∫–Ω–æ–ø–∫—É –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
- [ ] Test Case 2: –ù–∞–∂–∞—Ç–∏–µ –Ω–∞ –∫–Ω–æ–ø–∫—É –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç WebApp —Å–æ–æ–±—â–µ–Ω–∏–µ
- [ ] Test Case 3: WebApp –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –≤—Ö–æ–¥–æ–º
- [ ] Test Case 4: –î–æ—Å—Ç—É–ø –∫ —Ä–µ—Å—É—Ä—Å–∞–º –≤ AdminJS —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Test Case 5: –ù–µ–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –ù–ï –≤–∏–¥–∏—Ç –∫–Ω–æ–ø–∫—É
- [ ] Test Case 6: –ù–µ–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –ø–æ–ª—É—á–∞–µ—Ç 403 –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –¥–æ—Å—Ç—É–ø–∞
- [ ] Test Case 7: –ò—Å—Ç–µ–∫—à–∏–π —Ç–æ–∫–µ–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### –°—Ç–∞—Ç—É—Å

**–î–∞—Ç–∞ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è**: _____________________
**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ**: ____________________________
**–†–µ–∑—É–ª—å—Ç–∞—Ç**: ‚úÖ PASSED / ‚ùå FAILED

### –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

| # | –û–ø–∏—Å–∞–Ω–∏–µ | Severity | –°—Ç–∞—Ç—É—Å |
|---|----------|----------|--------|
| 1 |          |          |        |
| 2 |          |          |        |

---

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–Ω–æ–ø–∫–∞ "üîß –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å" –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. Username –Ω–µ –≤ —Ç–∞–±–ª–∏—Ü–µ `admins`
   ```sql
   SELECT * FROM admins WHERE telegram_username = 'maksim_tereshin';
   ```
2. TelegramService –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç AdminService.isAdmin()
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: `docker logs bizass-backend-dev | grep isAdmin`
3. Hardcoded ADMIN_USERNAMES –µ—â–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (deprecated)
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å telegram.constants.ts

**–†–µ—à–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–∏—Ç—å username –≤ —Ç–∞–±–ª–∏—Ü—É admins
- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å backend: `docker restart bizass-backend-dev`

### –ü—Ä–æ–±–ª–µ–º–∞: 403 Forbidden –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. –¢–æ–∫–µ–Ω –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π JWT_SECRET)
2. –¢–æ–∫–µ–Ω –∏—Å—Ç–µ–∫ (>15 –º–∏–Ω—É—Ç)
3. Session –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å JWT_SECRET –≤ .env
- –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω —á–µ—Ä–µ–∑ –±–æ—Ç–∞
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å express-session –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ main.ts

### –ü—Ä–æ–±–ª–µ–º–∞: WebApp –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. BACKEND_URL –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤ .env
2. Backend –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑–≤–Ω–µ (—Ç–æ–ª—å–∫–æ localhost)
3. CORS –ø—Ä–æ–±–ª–µ–º—ã

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å BACKEND_URL: `echo $BACKEND_URL`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å: `curl ${BACKEND_URL}/admin`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ main.ts

---

## References

- **Spec**: [spec.md](../spec.md)
- **Tasks**: [tasks.md](../tasks.md)
- **TelegramService**: [backend/src/telegram/telegram.service.ts](../../../../backend/src/telegram/telegram.service.ts)
- **AdminAuthMiddleware**: [backend/src/main.ts](../../../../backend/src/main.ts)
- **AdminService**: [backend/src/admin/admin.service.ts](../../../../backend/src/admin/admin.service.ts)
